angular.module("ualib.staffdir.templates",["staff-card/staff-card-list.tpl.html","staff-card/staff-card-md.tpl.html","staff-directory/staff-directory-facets.tpl.html","staff-directory/staff-directory-listing.tpl.html","staff-directory/staff-directory.tpl.html","staff-profile/staff-profile.tpl.html"]),angular.module("staff-card/staff-card-list.tpl.html",[]).run(["$templateCache",function(a){a.put("staff-card/staff-card-list.tpl.html",'<div ng-repeat="person in filteredList track by $index">\n    <div class="page-slice">\n        <div class="row">\n            <div class="col-xs-12 col-sm-1">\n                <div class="alpha-index-header" ng-if="person.alphaIndex[staffdir.facet.sortBy] != filteredList[$index-1].alphaIndex[staffdir.facet.sortBy]">\n                    <div ui-scrollfix="+0">\n                        {{person.alphaIndex[staffdir.facet.sortBy]}}\n                    </div>\n                </div>\n            </div>\n            <div class="col-xs-4 col-sm-3">\n                <img class="staff-portrait thumbnail" ng-src="{{person.photo}}" />\n            </div>\n            <div class="col-xs-8">\n                <div class="row">\n                    <div class="col-xs-12 col-sm-7 name-plate">\n                        <h3 class="name">\n                            <small ng-if="person.rank">{{person.rank}}</small>\n                            <a ng-href="/#/staffdir/profile/{{person.emailPrefix}}" ng-if="person.profile !== null">\n                                <span ng-class="{\'sorting-by\': staffdir.facet.sortBy == \'firstname\'}" ng-bind-html="person.firstname | highlight:staffdir.facet.search"></span>\n                                <span ng-class="{\'sorting-by\': staffdir.facet.sortBy == \'lastname\'}" ng-bind-html="person.lastname | highlight:staffdir.facet.search"></span>\n                            </a>\n                            <span ng-if="person.profile == null">\n                                <span ng-class="{\'sorting-by\': staffdir.facet.sortBy == \'firstname\'}" ng-bind-html="person.firstname | highlight:staffdir.facet.search"></span>\n                                <span ng-class="{\'sorting-by\': staffdir.facet.sortBy == \'lastname\'}" ng-bind-html="person.lastname | highlight:staffdir.facet.search"></span>\n                            </span>\n                        </h3>\n                        <h4 class="title"><span ng-bind-html="person.title | highlight:staffdir.facet.search"></span></h4>\n                        <h5 class="hidden-xs"><span ng-bind-html="person.department | highlight:staffdir.facet.search"></span></h5>\n\n                    </div>\n                    <div class="col-xs-12 col-sm-5">\n                        <ul class="fa-ul">\n                            <li ng-if="person.phone"><span class="fa fa-phone fa-li"></span>{{person.phone}}</li>\n                            <li class="hidden-xs" ng-if="person.fax"><span class="fa fa-fax fa-li"></span>{{person.fax}}</li>\n                            <li ng-if="person.email"><span class="fa fa-envelope fa-li"></span><a ng-href="mailto:{{person.email}}" title="Email {{person.firstname}} {{person.lastname}}">{{person.email}}</a></li>\n                        </ul>\n                    </div>\n                    <div class="col-sm-12 subject-specialty hidden-xs" ng-if="person.subjects">\n                        <table class="table table-condensed">\n                            <thead>\n                            <tr>\n                                <th>Subject specialty</th>\n                                <th class="text-center">Selector</th>\n                                <th class="text-center">Instruction</th>\n                            </tr>\n                            </thead>\n                            <tbody>\n                            <tr ng-repeat="subject in person.subjects | orderBy:\'subject\'">\n                                <td>\n                                    <a ng-href="{{subject.link}}" title="{{subject.subject}}" ng-if="subject.link" ng-bind-html="subject.subject | highlight:staffdir.facet.search"></a>\n                                    <span ng-if="!subject.link" ng-bind-html="subject.subject | highlight:staffdir.facet.search">{{subject.subject}}</span>\n                                </td>\n                                <td class="text-center"><span class="fa fa-circle text-info" ng-if="subject.type == 1 || subject.type == 3"></span></td>\n                                <td class="text-center"><span class="fa fa-circle text-info" ng-if="subject.type > 1"></span></td>\n                            </tr>\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div class="alert alert-warning text-center" role="alert" ng-if="filteredList.length < 1">\n    <h2>\n        No staff members found\n        <span ng-if="staffdir.facet.library"> in {{staffdir.facet.library}}</span>\n        <span ng-if="staffdir.facet.selector"> that are subject selectors</span>\n        <span ng-if="staffdir.facet.instructor"><span ng-if="staffdir.facet.selector"> or</span> <span ng-if="!staffdir.facet.selector"> that are</span> instruction librarians</span>\n                <span ng-if="staffdir.facet.subject">\n                    <span ng-if="staffdir.facet.selector || staffdir.facet.instructor"> for</span>\n                    <span ng-if="!staffdir.facet.selector && !staffdir.facet.instructor"> with a specialty in</span>\n                     {{staffdir.facet.subject}}\n                </span>\n    </h2>\n</div>')}]),angular.module("staff-card/staff-card-md.tpl.html",[]).run(["$templateCache",function(a){a.put("staff-card/staff-card-md.tpl.html",'<div class="staff-card-container panel panel-default">\n    <div class="panel-body">\n        <div class="row">\n            <div class="name-plate col-sm-12 text-right">\n                <h4 class="name"><small ng-if="staffPerson.rank">{{staffPerson.rank}} </small>{{staffPerson.firstname}} {{staffPerson.lastname}}</h4>\n                <div class="title">{{staffPerson.title}}</div>\n                <div class="">{{staffPerson.department}}</div>\n            </div>\n        </div>\n        <div class="row">\n            <div class="col-xs-6">\n                <div class="staff-card-detail">\n                    <h6>Contact</h6>\n                    <ul class="fa-ul">\n                        <li ng-if="staffPerson.phone"><span class="fa fa-phone fa-li"></span>{{staffPerson.phone}}</li>\n                        <li ng-if="staffPerson.fax"><span class="fa fa-fax fa-li"></span>{{staffPerson.fax}}</li>\n                        <li ng-if="staffPerson.email"><span class="fa fa-envelope fa-li"></span><a href="mailto:{{staffPerson.email}}">{{staffPerson.email}}</a></li>\n                    </ul>\n                </div>\n            </div>\n            <div class="col-xs-6">\n                <div class="staff-card-detail" ng-if="staffPerson.subjects">\n                    <h6>Subject Expertise</h6>\n                    <ul class="list-unstyled">\n                        <li role="presentation" ng-repeat="subject in staffPerson.subjects | orderBy:subject.subject" ng-class="{\'disabled\': !subject.link}">\n                            <a ng-href="{{subject.link}}" title="{{subject.subject}}" ng-if="subject.link">{{subject.subject}}</a>\n                            <span title="{{subject.subject}}" ng-if="!subject.link">{{subject.subject}}</span>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>')}]),angular.module("staff-directory/staff-directory-facets.tpl.html",[]).run(["$templateCache",function(a){a.put("staff-directory/staff-directory-facets.tpl.html",'<form class="facets-form">\n    <div class="form-group">\n        <h4>Filters</h4>\n    </div>\n    <div class="form-group">\n        <div class="facet-group">\n            <input class="form-control" id="directorySearch" name="directorySearch" type="text" ng-model="staffdir.facet.search" placeholder="Keyword Search..." ng-keyup="staffdir.changeFacet(\'search\')"/>\n        </div>\n    </div>\n\n    <div class="form-group">\n        <h5>Sort by</h5>\n        <div class="facet-group">\n            <div class="btn-group btn-group-justified">\n                <label class="btn btn-default" ng-model="staffdir.facet.sortBy" btn-radio="\'lastname\'" uncheckable ng-change="staffdir.changeFacet(\'sortBy\')">Last name</label>\n                <label class="btn btn-default" ng-model="staffdir.facet.sortBy" btn-radio="\'firstname\'" uncheckable ng-change="staffdir.changeFacet(\'sortBy\')">First name</label>\n            </div>\n        </div>\n    </div>\n\n    <div class="form-group hidden-xs hidden-sm">\n        <h5>Subject specialty</h5>\n\n        <div class="facet-group">\n\n            <select class="form-control" ng-model="staffdir.facet.subject" name="subject" ng-options="subject for subject in facets.subjects" ng-change="staffdir.changeFacet(\'subject\')">\n                <option value="">-- Select Subject --</option>\n            </select>\n            <label class="checkbox-inline">\n                <input type="checkbox" id="selector" ng-true-value="1" ng-model="staffdir.facet.selector" ng-change="staffdir.changeFacet(\'selector\')"> Selector\n            </label>\n            <label class="checkbox-inline">\n                <input type="checkbox" id="instructor" ng-true-value="2" ng-model="staffdir.facet.instructor" ng-change="staffdir.changeFacet(\'instructor\')"> Instructor\n            </label>\n        </div>\n    </div>\n\n    <div class="form-group hidden-xs hidden-sm">\n        <h5>Department</h5>\n        <div class="facet-group">\n            <select class="form-control" ng-model="staffdir.facet.department" name="department" ng-options="department for department in facets.departments" ng-change="staffdir.changeFacet(\'department\')">\n                <option value="">-- Select Department --</option>\n            </select>\n        </div>\n    </div>\n\n    <div class="form-group hidden-xs hidden-sm">\n        <h5>Library</h5>\n        <div class="facet-group">\n            <div class="radio">\n                <label>\n                    <input type="radio" ng-model="staffdir.facet.library" value="" ng-checked="!staffdir.facet.library" ng-change="staffdir.changeFacet(\'library\')"> All\n                </label>\n            </div>\n            <div class="radio" ng-repeat="library in facets.libraries">\n                <label>\n                    <input type="radio" ng-model="staffdir.facet.library" value="{{library}}" ng-change="staffdir.changeFacet(\'library\')"> {{library}}\n                </label>\n            </div>\n        </div>\n    </div>\n\n    <div class="form-group">\n        <button class="btn btn-primary btn-block hidden-xs" type="button" ng-click="staffdir.clearFacets()">\n            <span class="fa fa-fw fa-refresh"></span> Reset Filters\n        </button>\n    </div>\n</form>')}]),angular.module("staff-directory/staff-directory-listing.tpl.html",[]).run(["$templateCache",function(a){a.put("staff-directory/staff-directory-listing.tpl.html",'<div class="table-responsive">\n    <table class="table table-striped table-condensed table-hover">\n        <thead>\n        <tr>\n            <th>\n                <a href="#"\n                   ng-click="sortList($event, \'lastname\')"\n                   ng-class="{\'sortable\': !staffdir.sortReverse && staffdir.facet.sortBy == \'lastname\', \'sortable-reverse\': staffdir.sortReverse && staffdir.facet.sortBy == \'lastname\'}">Name</a>\n            </th>\n            <th class="hidden-xs">\n                <a href="#" \n                   ng-click="sortList($event, \'title\')" \n                   ng-class="{\'sortable\': !staffdir.sortReverse && staffdir.facet.sortBy == \'title\', \'sortable-reverse\': staffdir.sortReverse && staffdir.facet.sortBy == \'title\'}">Title</a>\n            </th>\n            <th class="hidden-xs">\n                <a href="#" \n                   ng-click="sortList($event, \'department\')" \n                   ng-class="{\'sortable\': !staffdir.sortReverse && staffdir.facet.sortBy == \'department\', \'sortable-reverse\': staffdir.sortReverse && staffdir.sortBy == \'department\'}">Department/Unit</a>\n            </th>\n            <th>Contact</th>\n            <th class="hidden-xs hidden-sm">Specialty</th>\n        </tr>\n        </thead>\n        <tbody>\n        <tr ng-repeat="person in filteredList = (list | filter:staffdir.facet.search | filter:staffdir.facet.subject:true | orderBy:staffdir.sortBy:staffdir.sortReverse) track by $index">\n            <td class="text-nowrap">\n                <div ng-if="person.rank" class="text-muted"> {{person.rank}}</div>\n                <span ng-bind-html="person.firstname | highlight:staffdir.facet.search"></span> <strong ng-bind-html="person.lastname | highlight:staffdir.facet.search"></strong>\n\n            </td>\n            <td class="hidden-xs"><span ng-bind-html="person.title | highlight:staffdir.facet.search"></span></td>\n            <td class="hidden-xs"><span ng-bind-html="person.department | highlight:staffdir.facet.search"></span></td>\n            <td>\n                <ul class="fa-ul">\n                    <li ng-if="person.phone"><span class="fa fa-phone fa-li"></span>{{person.phone}}</li>\n                    <li ng-if="person.fax"><span class="fa fa-fax fa-li"></span>{{person.fax}}</li>\n                    <li ng-if="person.email"><span class="fa fa-envelope fa-li"></span> <a ng-href="mailto:{{person.email}}" title="Email {{person.firstname}} {{persone.lastname}}">{{person.email}}</a></li>\n                </ul>\n            </td>\n            <td class="hidden-xs hidden-sm">\n                <ul class="list-unstyled" ng-if="person.subjects">\n                    <li ng-repeat="subject in person.subjects | orderBy:subject.subject">\n                        <a ng-href="{{subject.link}}" title="{{subject.subject}}" ng-if="subject.link" ng-bind-html="subject.subject | highlight:staffdir.facet.search"></a>\n                        <span ng-if="!subject.link" ng-bind-html="subject.subject | highlight:staffdir.facet.search">{{subject.subject}}</span>\n                    </li>\n                </ul>\n            </td>\n        </tr>\n        </tbody>\n    </table>\n    <div class="alert alert-warning text-center" role="alert" ng-show="filteredList.length === 0">\n        <h2>\n            No results<span ng-if="staffdir.facet.subject"><strong> for {{staffdir.facet.subject}}</strong> subject specialists</span>\n            <span ng-if="staffdir.facet.search"> matching <strong>"{{staffdir.facet.search}}"</strong></span>\n        </h2>\n    </div>\n</div>')}]),angular.module("staff-directory/staff-directory.tpl.html",[]).run(["$templateCache",function(a){a.put("staff-directory/staff-directory.tpl.html",'<div class="page-header">\n    <h1>Staff Directory</h1>\n</div>\n\n\n<div class="row">\n    <div class="col-md-3 col-md-push-9">\n        <div class="staff-directory-facets" facets="staffdir.facets"></div>\n    </div>\n    <div class="col-md-9 col-md-pull-3">\n        <div ng-show="facets.showFacetBar">\n            <ol class="breadcrumb facetcrumb">\n                <li ng-if="facets.facet.department"><strong>Department:</strong> <button type="button" class="btn btn-default" ng-click="facets.clearFacets(\'department\')">{{facets.facet.department | truncate : 20 : \'...\'}} <span class="text-muted" aria-hidden="true">&times;</span></button></li>\n                <li ng-if="facets.facet.library"><strong>Library:</strong> <button type="button" class="btn btn-default" ng-click="facets.clearFacets(\'library\')">{{facets.facet.library}} <span class="text-muted" aria-hidden="true">&times;</span></button></li>\n                <li ng-if="facets.facet.subject"><strong>Subject:</strong> <button type="button" class="btn btn-default" ng-click="facets.clearFacets(\'subject\')">{{facets.facet.subject}} <span class="text-muted" aria-hidden="true">&times;</span></button></li>\n                <li ng-if="facets.facet.selector"><button type="button" class="btn btn-default" ng-click="facets.clearFacets(\'selector\')">Selector <span class="text-muted" aria-hidden="true">&times;</span></button></li>\n                <li ng-if="facets.facet.instructor"><button type="button" class="btn btn-default" ng-click="facets.clearFacets(\'instructor\')">Instructor <span class="text-muted" aria-hidden="true">&times;</span></button></li>\n\n                <li class="pull-right"><button type="button" class="btn btn-primary btn-small reset-btn" title="Reset filters" ng-click="facets.clearFacets()"><i class="fa fa-refresh"></i></button></li>\n            </ol>\n        </div>\n        <div class="staff-directory-listing" list="staffdir.list" sort-by="lastname"></div>\n    </div>\n</div>\n\n\n\n')}]),angular.module("staff-profile/staff-profile.tpl.html",[]).run(["$templateCache",function(a){a.put("staff-profile/staff-profile.tpl.html",'<h2>Faculty/Staff Profile</h2>\n<div class="row">\n    <div class="col-md-3">\n        <img class="staff-portrait thumbnail" ng-src="{{userProfile.person.photo}}" ng-if="userProfile.person.photo != null"\n             width="180" height="225">\n        <img class="staff-portrait thumbnail" ng-src="wp-content/themes/roots-ualib/assets/img/user-profile.png"\n             ng-if="userProfile.person.photo == null" width="180" height="225">\n    </div>\n    <div class="col-md-9">\n        <h3 class="name">\n            <small ng-if="userProfile.person.rank">{{userProfile.person.rank}}</small>\n            <span ng-bind-html="userProfile.person.firstname"></span> <span ng-bind-html="userProfile.person.lastname"></span>\n        </h3>\n        <h4 class="title"><span ng-bind-html="userProfile.person.title"></span></h4>\n        <h5 class="hidden-xs"><span ng-bind-html="userProfile.person.department"></span></h5>\n        <ul class="fa-ul">\n            <li ng-if="userProfile.person.phone"><span class="fa fa-phone fa-li"></span>{{userProfile.person.phone}}</li>\n            <li class="hidden-xs" ng-if="userProfile.person.fax"><span class="fa fa-fax fa-li"></span>{{userProfile.person.fax}}</li>\n            <li ng-if="userProfile.person.email"><span class="fa fa-envelope fa-li"></span>\n                <a href="mailto:{{userProfile.person.email}}">{{userProfile.person.email}}</a>\n            </li>\n        </ul>\n    </div>\n</div>\n<div class="row">\n    <div class="col-md-12">\n        <span ng-bind-html="userProfile.person.profile"></span>\n    </div>\n</div>\n')}]),angular.module("ualib.staffdir",["ngRoute","ngResource","ngAnimate","ngSanitize","angular.filter","ui.bootstrap","ui.utils","ualib.ui","ualib.staffdir.templates"]),angular.module("staffdir",["ualib.staffdir"]),angular.module("ualib.staffdir").run(["StaffDirectoryService","$location","$rootScope",function(a,b,c){c.$on("$routeChangeStart",function(c,d,e){if("/staffdir"===d.originalPath){var f=b.search();for(var g in f)a.showFacetBar||a.facetExceptions.hasOwnProperty(g)||(a.showFacetBar=!0),a.facet[g]=f[g],console.log(a.facet)}})}]).service("StaffDirectoryService",["$location","$rootScope",function(a,b){function c(a){var b;for(b in a)if(a[b]&&!d.facetExceptions.hasOwnProperty(b))return!1;return!0}var d=this;this.sortReverse=!1,this.sortable={},this.facet={},this.facetExceptions={sortBy:"lastname",search:""},this.showFacetBar=!1,this.clearFacets=function(){var e=arguments.length?arguments:Object.keys(d.facet),f=Array.prototype.concat.apply(Array.prototype,e),g={},h={};Object.keys(d.facet).map(function(b){d.facetExceptions.hasOwnProperty(b)?(h[b]=d.facetExceptions[b],a.search(b,null)):-1===f.indexOf(b)?(h[b]=d.facet[b],g[b]=d.facet[b]):a.search(b,null)}),d.showFacetBar=!c(g),d.facet=angular.copy(h),b.$broadcast("facetsChange")},this.changeFacet=function(e){var f=d.facet.hasOwnProperty(e)&&""!==d.facet[e]&&d.facet[e]!==!1?d.facet[e]:null;a.search(e,f),a.replace(),d.showFacetBar=!c(d.facet),b.$broadcast("facetsChange")},this.specialtyType=function(a){var b=d.facet.selector|d.facet.instructor;return b?a.subjects.filter(function(a){var c=(a.type&b)===b;return 3===b?d.facet.subject?d.facet.subject===a.subject&&a.type>0:a.type>0:d.facet.subject?d.facet.subject===a.subject&&c:c}).length>0:!0}}]),angular.module("ualib.staffdir").factory("StaffFactory",["$resource","$filter","$http",function(a,b,c){function d(a,b){return a=angular.isArray(a)?a:[a],a.concat(b)}return{directory:function(){return a("//wwwdev2.lib.ua.edu/staffDir/api/people",{},{cache:!0,get:{method:"GET",transformResponse:d(c.defaults.transformResponse,function(a){var c=angular.fromJson(a),d={list:[],facets:{}},e=[],f=[];return angular.forEach(c.list,function(a){delete a.division,null==a.photo&&(a.photo="/wp-content/themes/roots-ualib/assets/img/user-profile.png");var b=/^([\w-]+(?:\.[\w-]+)*)/,c=a.email.match(b);null!==c?a.emailPrefix=c[0]:console.log(a.email),a.alphaIndex={},a.alphaIndex.lastname=a.lastname.charAt(0).toUpperCase(),a.alphaIndex.firstname=a.firstname.charAt(0).toUpperCase(),f.push(a),angular.isDefined(a.subjects)&&a.subjects.length>0&&angular.forEach(a.subjects,function(a){e.push(a)})}),e=b("unique")(e,"subject"),e=b("orderBy")(e,"subject"),d.facets.subjects=e.map(function(a){return a.subject}),d.facets.libraries=c.libraries.map(function(a){return a.name}),d.facets.departments=c.departments.map(function(a){return a.name}),d.list=f,d})}})},byEmail:function(){return a("//wwwdev2.lib.ua.edu/staffDir/api/people/search/email/:email",{},{cache:!0})},byName:function(){return a("//wwwdev2.lib.ua.edu/staffDir/api/people/search/firstname/:firstname/lastname/:lastname",{},{cache:!0})},byId:function(){return a("//wwwdev2.lib.ua.edu/staffDir/api/people/search/id/:id",{},{cache:!0})},profile:function(){return a("//wwwdev2.lib.ua.edu/staffDir/api/profile/:login",{},{cache:!0})}}}]),angular.module("ualib.staffdir").config(["$routeProvider",function(a){a.when("/staffdir/cardlist",{template:'<div class="staff-card-list"></div>'})}]).directive("staffCardList",["StaffFactory",function(a){return{restrict:"AC",templateUrl:"staff-card/staff-card-list.tpl.html",controller:["$scope",function(b){b.staffdir={},a.directory().get().$promise.then(function(a){b.staffdir=a.list},function(){console.log("Staffdir Error -- Come on, put in proper error handling already")})}]}}]).directive("staffCard",["StaffFactory",function(a){return{restrict:"EA",scope:{person:"@",size:"@"},templateUrl:function(a,b){var c="staff-card/";switch(b.size){case"sm":c+="staff-card-sm.tpl.html";break;default:c+="staff-card-md.tpl.html"}return c},link:function(b,c){if(console.log(b.person),angular.isDefined(b.person))if(b.info={},angular.isNumber(b.person))a.byId().get({id:b.person}).$promise.then(function(a){b.staffPerson=a.list[0]},function(){console.log("Staffdir Error -- Come on, put in proper error handling already")});else{var d=b.person.split(/\s/);d.length>1?(console.log({firstname:d[0],lastname:d[1]}),a.byName().get({firstname:d[0],lastname:d[1]}).$promise.then(function(a){b.staffPerson=a.list[0]},function(){console.log("Staffdir Error -- Come on, put in proper error handling already")})):a.byEmail().get({email:d[0]}).$promise.then(function(a){b.staffPerson=a.list[0]},function(){console.log("Staffdir Error -- Come on, put in proper error handling already")})}}}}]),angular.module("ualib.staffdir").config(["$routeProvider",function(a){a.when("/staffdir",{reloadOnSearch:!1,controller:"StaffDirCtrl",templateUrl:"staff-directory/staff-directory.tpl.html",resolve:{StaffDir:["StaffFactory",function(a){return a.directory().get().$promise.then(function(a){return a},function(a,b){return console.log("Error"+b+": "+a),staff})}]}})}]).controller("StaffDirCtrl",["$scope","StaffDir","StaffDirectoryService",function(a,b,c){a.staffdir=b,a.facets=c}]).directive("staffDirectoryListing",["StaffDirectoryService","$filter",function(a,b){return{restrict:"AC",scope:{list:"=",sortBy:"@"},templateUrl:"staff-card/staff-card-list.tpl.html",controller:["$scope",function(c){function d(){var a=angular.copy(c.list);a=b("filter")(a,c.staffdir.facet.search),a=b("filter")(a,c.staffdir.facet.department),a=b("filter")(a,c.staffdir.facet.subject,!0),a=b("filter")(a,c.staffdir.facet.library),a=b("filter")(a,c.staffdir.specialtyType),a=b("orderBy")(a,c.staffdir.facet.sortBy,c.staffdir.sortReverse),c.filteredList=angular.copy(a)}c.filteredList=[],c.staffdir=a,angular.isUndefined(a.facet.sortBy)&&(c.staffdir.facet.sortBy=angular.isDefined(c.sortBy)?c.sortBy:"lastname");var e=c.$on("facetsChange",function(a){d()});c.$on("$destroy",function(){e()}),d()}]}}]).directive("staffDirectoryFacets",["StaffDirectoryService",function(a){return{restrict:"AC",scope:{facets:"="},templateUrl:"staff-directory/staff-directory-facets.tpl.html",controller:["$scope",function(b){b.staffdir=a}]}}]).filter("alphaIndex",function(){return function(a,b){var c=a.map(function(a){return a.alphaIndex=a[b].charAt(0).toUpperCase(),a});return c}}),angular.module("ualib.staffdir").config(["$routeProvider",function(a){a.when("/staffdir/profile/:email",{template:function(a){return'<div class="staff-faculty-profile" email="'+a.email+'"></div>'}})}]).directive("staffFacultyProfile",["StaffFactory",function(a){return{restrict:"AC",scope:{login:"@email"},templateUrl:"staff-profile/staff-profile.tpl.html",controller:["$scope",function(b){b.userProfile={},console.log("Login: "+b.login),a.profile().get({login:b.login}).$promise.then(function(a){b.userProfile=a,console.dir(a)},function(a){console.log("Error: cold not get profile! "+a)})}]}}]);